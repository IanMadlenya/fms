<!doctype html>
<html>
<head>

<meta charset="utf-8"> 
<meta http-equiv="x-ua-compatible" content="ie=edge"> 

<title>
Fundamental Theorem of Asset Pricing
</title>

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/javascript" src="mathjax.js"></script>
<link rel="stylesheet" type="text/css" href="ftap.css">
</head>
<body>
<h1>Fundamental Theorem of Asset Pricing</h1>
<p>
This theorem is the foundation for pricing, hedging, and managing
the risk of derivative securities.
Unfortunately, it seems to have been hijacked by people who
are more in love with mathematics than in solving practical
day-to-day problems faced by traders and risk managers.
<p>
If "There should be no sequence of final payoffs of admissible integrands,
\(f_n = (H^n\cdot S)_\infty\), such that the negative parts \(f_n^-\)
tend to zero uniformly and such that \(f_n\) tends almost surely to a
\([0,\infty]\)-valued function \(f_0\) satisfying \(P[f_0 > 0] > 0\)."
makes sense to you, my hat is off to you. I have a PhD in math and
know all about the problem of the unit ball in \(L^\infty\) not having
any non-trivial weak\(^*\)-closed subsets and the mathematical gyrations
required to get the Hahn-Banach theorem working in this unfortunate
situation.
</p>
<p>
If you couldn't care less about this sort of mathematical masturbation,
allow me to introduce you to a version of the theorem that is very
easy to understand and can be applied to solving real world problems.
</p>
<h2>Finance</h2>
<p>
The simple mathematics required for a complete theory is provided below.
For now we will play with mathematical symbols in a way that
hopefully reflects your intuition about how financial markets work.
</p>
<p>
<h3>Trading</h3>
Trades can happen at <em>times</em> \(t_0 < t_1 < t_2 \dots\).
The <em>price</em> of all market instruments available for trading
at time \(t_j\) is the
vector \(X_j\). Market instruments pay <em>cash flows</em> \(C_j\) at
time \(t_j\) associated with owning them: bonds pay coupons, stocks
pay dividends, spot FX trades pay the difference in interest rates
in the currency pair.
</p>
<p>
You can <em>trade</em> the vector \(\Gamma_j\) 
in market instruments at time \(t_j\) and build a
<em>position</em> \(\Delta_j = \sum_{i\le j}\Gamma_i\).  If you actually
do this, your broker will send you <em>account</em> statements. At time
\(t_j\) you will see \(A_j = \Delta_{j-1}\cdot C_j - \Gamma_j\cdot X_j\)
show up: you get all the cash flows associated with your
existing position and have to pay for the trades you execute.
The <em>value</em> of your position at \(t_j\) is
\(V_j = \Delta_j\cdot X_j\), assuming you could liquidate it
at prevailing market prices.
</p>
<p>
If you can find trades \(\Gamma_j\) that eventually close out your
position with \(A_0 > 0\) and \(A_j\ge0\) for \(j>0\), that is
arbitrage. You make money up front and never lose until you unwind
your position.
</p>
<h3>Models</h3>
<p>
The job of a quant is to come up with models of prices and cash flows
that are arbitrage free and allow for possible price movements.
They have been falling down on the job of giving a good measure of
how bad their models are. Every trader knows no hedge is perfect.
</p>
<p>
The Fundamental Theorem of Asset Pricing is that a model is arbitrage
free if, and only if, there exist <em>positive measures</em> \(\Pi_j\) such
that
\[
	X_j\Pi_j = (C_{j+1} + X_{j+1})\Pi_{j+1}|_j
\]
You don't need to know what a measure is or the funny \(|_j\) thing at
the end that means 'given information known at time \(t_j\)' to
understand how this theorem allows you to price derivative secuities.
</p>
<p>
\begin{align*}
V_j\Pi_j &= \Delta_j\cdot X_j\Pi_j\\
&= \Delta_j\cdot(C_{j+1} + X_{j+1})\Pi_{j+1}|_j\\
&= (A_{j+1} + \Gamma_{j+1}\cdot X_{j+1}
+ \Delta_j\cdot X_{j+1})\Pi_{j+1}|_j\\
&= (A_{j+1} + \Delta_{j+1}\cdot X_{j+1})\Pi_{j+1}|_j\\
&= (A_{j+1} + V_{j+1})\Pi_{j+1}|_j\\
\end{align*}
The value \(V_j\) acts like a price and the account \(A_j\) acts
like a cash flow.
</p>
<p>
By induction,
\[
V_j\Pi_j = (\sum_{j\lt i\le k}A_i\Pi_i + V_k\Pi_k)|_j.
\]
</p>
<p>
We can multiply the \(\Pi_j\) by any positive number so we
can and do assume \(\Pi_0 = 1\).
If \((\Gamma_j)\) eventually close
out then \(V_0 = \sum_{i>0} A_i\Pi_i|_0\).
If \(A_i\ge 0\) for \(i > 0\) then \(V_0\ge 0\). Since
\(V_0 = \Delta_0\cdot X_0 = \Gamma_0\cdot X_0 = -A_0\)
we have \(A_0\le 0\). This proves the easy direction of the
FTAP.
</p>
<h3>Derivatives</h3>
<p>
A <em>derivative security</em> is an agreement between two
counterparties about a sequence of payments. A <em>buyer</em>
pays the <em>seller</em> to provide payments
\((A_j)_{j=1}^n\) at corresponding times \((t_j)_{j=1}^n\).
<em><b>If</b></em> it were possible to find
trades \(\Gamma_j\) that close out (\(\Delta_n = 0\))
with \(A_j = \Delta_{j-1}\cdot C_j - \Gamma_j\cdot X_j\)
then the cost of the initial hedge is
\[
V_0 = \sum_{i=1}^n A_i\Pi_i|_0
\]
since \(V_n = \Delta_n\cdot X_n = 0\). But how do we find
such \(\Gamma_j\)?
Since \(V_0 = \Delta_0\cdot X_0\) we have
\(\Gamma_0 = \Delta_0 = dV_0/dX_0\) so we know the initial
delta hedge. At any time \(t_j\) the same prescription
holds: \(\Delta_j = dV_j/dX_j\). The trade at time \(t_j\)
to hedge the position is \(\Gamma_j = \Delta_j - \Delta_{j-1}\).
</p>
<p>
So far, so easy. What's the catch? The catch is that there is
no guarantee that \(A_j = \Delta_{j-1}\cdot C_j - \Gamma_j\cdot X_j\).
The left hand side is specified by the contract. The right hand
side follows from the delta hedging prescription above.
The difference is your \(t_j\)-ly profit and loss.
</p>
<p>
Quants cook up the measures \(\Pi_j\), and keep changing (aka
recalibrating) them them every day, or even every minute.  Traders press
a button to get \(V_0 = \sum A_j\Pi_j|_0\) where the \(A_j\) are specified
by the term sheet, then add some amount proportional to how irritating the
gamma profile looks to them.  Risk managers then proceed to empirically
verify Taylor's theorem every day to "explain" the profit and loss.

</p>

<h2>Mathematics</h2>
<p>
Time to rigorously define things using math. Then we can write
down some true statements and be certain they are correct.
That is what math was designed for.
</p>
<h3>Partitions</h3>
A <em>parition</em> is the mathematical way of
describing partial information. A partion of a set
is a collection of disjoint subsets whos union
equals the entire set.
<p>
Let \(\Omega\) be the set of all possible <em>outcomes</em> in a model.
To model rolling
a die, the set \(\Omega = \{1,2,3,4,5,6\}\) will do. To
represent the partial information that we only know if
the roll was even or odd we can use the partition
\(\{\{1,3,5\},\{2,4,6\}\}\). We don't know what the
roll is, but we know which of these two sets it belongs to.
Perfect knowledge is represented by the partion of
singleton sets: \(\{\{1\},\dots,\{6\}\}\). 
Complete lack of knowledge is the partition having
only one subset: \(\{\Omega\}\).
</p>
<p>
A <em>measure</em> is a function from a partition to the
real numbers, \(\RR\). If you know the usual mathematical
definition of a measure, just extend this to the
algebra of sets generated by the partition. It obviously
satisfies the condition that the measure of the
union of two disjoint sets is the sum of their individual
measures. If you are hoping to hear about \(\sigma\)-algebras
I'm afraid you will be disappointed. We have no need for
dainty measure theoretic notions required to prove theorems
about interchanging limits.
</p>
<p>
</p>
<p>
In mathematical finance the set of outcomes can be quite
large. In the Black-Scholes/Merton model \(\Omega = C[0,\infty)\)
- the space of continuous functions on the non-negative real
numbers. These represent the possible trajectories of the
log of the stock price.
</p>
<p>
There is no reason \(\Omega\) couldn't also contain historical prices.
Or the text of every past financial publication.
Or any publication. Or any possible future publication.
Math lets you think as big as you wish even though it might
not be practical to implement.
</p>
<h3>Filtrations</h3>
<p>
Given times \(t_0 < t_1 < \cdots\), a <em>filtration</em>
is an increasing sequence of partitions
\(\PP_0\subseteq\PP_1\subseteq\cdots\).
The partition \(\PP_j\) represents the information available
at time \(t_j\). A function on \(\Omega\) is \(\PP_j\)
<em>measurable</em> if it is constant on each set in
the partition.
</p>


<h3>Bounded Functions</h3>
<p>
We represent prices, cash flows, and trades by the set of
bounded functions,
\[
B(\Omega) = \{f\colon\Omega\to\RR\mathop{:}
\sup_{\omega\in\Omega} |f(\omega)| < \infty \}.
\]
</p>
<p>
There is no fixed bound on the size of the function, it just
can't keep growing without limit. Just as in the real world.
</p>

<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
    (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
    function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
    e=o.createElement(i);r=o.getElementsByTagName(i)[0];
    e.src='https://www.google-analytics.com/analytics.js';
    r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
    ga('create','UA-XXXXX-X','auto');ga('send','pageview');
</script>

</body>
</html>
